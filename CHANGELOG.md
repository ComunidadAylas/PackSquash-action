# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic
Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Fixed

- Fixed an issue where files modified in previous workflow steps were
  incorrectly categorized as unchanged by the action cache logic under some
  circumstances, causing PackSquash to reuse stale versions of those files.
  (Thank you __camm_ for reporting this issue over Discord!)

## [4.0.3] - 2024-12-13

### Changed

- Migrated the TOML parsing and serializing library from `@iarna/toml` to
  `smol-toml`. This new library is more lightweight, has fewer issues, and is
  better maintained.
  - This should fix a spurious TOML parse error for TOML files with comments and
    CRLF line endings.
- Migrated formatting and linting development tools from Prettier and ESLint to
  [Biome](https://biomejs.dev/), which is significantly faster and simpler to
  use and set up.
- Updated dependency on `@actions/cache` to `v4`, bringing [compatibility with
  new internal GitHub Actions Cache API versions which are claimed to be much
  faster](https://github.com/actions/toolkit/discussions/1890).
  - The previous API version is set to shut down in the near future, so this
    update is essential to ensure the action continues functioning as expected.

### Fixed

- The action will no longer occasionally hang for a few minutes when uploading
  the generated pack for caching.

## [4.0.2] - 2023-12-27

### Changed

- Updated dependency on `@actions/artifact` to
  [v2](https://github.com/actions/toolkit/blob/68f22927e727a60caff909aaaec1ab7267b39f75/packages/artifact/README.md#v2---whats-new),
  bringing potentially substantial performance improvements when uploading the
  generated ZIP file as an artifact.
  - Artifacts generated by earlier major versions of `@actions/artifact` are not
    accessible to this new version. Consequently, the action may fail to
    retrieve older artifacts, and steps that rely on older `@actions/artifact`
    versions will not see the new artifacts. Should this pose an issue for you,
    please consider updating your workflow to use the latest artifact libraries.
    Alternatively, if updating is not feasible at the moment, you can
    temporarily restrict the PackSquash action version tag to `v4.0.1`.

## [4.0.1] - 2023-10-24

### Changed

- Updated the action Node.js runner to 20 from 16.
- Several minor internal CI workflow tidy ups and dependency updates.

## [4.0.0] - 2023-06-25

### Added

- Introduced [internal PackSquash binary
  manifests](https://github.com/ComunidadAylas/PackSquash-action/tree/master/data/packsquash_binary_manifests)
  with machine-parsable instructions for downloading and executing PackSquash
  versions. These manifests are fetched by the action at runtime, decoupling the
  release cycles of the action and PackSquash and enabling backward and forward
  compatibility with different version combinations.
  ([`414ee5c`](https://github.com/ComunidadAylas/PackSquash-action/commit/414ee5cec8f1197f310e5c7e6f68b6efdffc1c66))
  - This means that **from now on it should be less likely to have to upgrade or
    downgrade the action to use a newer or older version of PackSquash**,
    respectively.
- **Windows and macOS runners are now supported**, as long as the PackSquash
  version used by the workflow is distributed in the required way. Currently,
  only v0.4.0 and the latest unstable builds will work with these operating
  systems.
  ([`414ee5c`](https://github.com/ComunidadAylas/PackSquash-action/commit/414ee5cec8f1197f310e5c7e6f68b6efdffc1c66))
- Created a **`CHANGELOG.md`** file to make it more comfortable for interested
  parties to track changes to the project.
- Configured **[Husky](https://typicode.github.io/husky/)** to provision project
  developers with a pre-commit Git hook that automatically builds the action
  bundle and stages it for commit. It is possible to opt out of executing this
  hook by using `git commit --no-verify`.
  ([`0c58a3b`](https://github.com/ComunidadAylas/PackSquash-action/commit/0c58a3b43337bd0ce16932f82927cd09c8515b25))

### Changed

- The **`packsquash_version` input parameter is now required**. Also, its
  special value of `latest` now refers to the latest release instead of the
  latest unstable build. A new `latest-unstable` value has been introduced to
  refer to the latest unstable build at the time the workflow is run.
- The **`options_file` input parameter has been renamed to `options`**, and it
  now accepts either a path to a TOML file or an inline TOML string containing
  the [options
  file](https://github.com/ComunidadAylas/PackSquash/wiki/Options-files) to pass
  to PackSquash.
  ([#59](https://github.com/ComunidadAylas/PackSquash-action/pull/59))
- The **`output_file_path` PackSquash option can now be changed**, allowing
  other steps in the workflow to rely on PackSquash to output its ZIP to a
  predictable location. (Related issue:
  [#62](https://github.com/ComunidadAylas/PackSquash-action/issues/62))
- Minor dependency updates.
- Several internal refactors and cleanups.

### Fixed

- Fixed system identifier caching not being handled correctly in some edge
  cases. ([#59](https://github.com/ComunidadAylas/PackSquash-action/pull/59))

### Removed

- The **`path` input has been removed**. A custom `pack_directory` option can be
  set using the new `options` input to achieve the same result.
- As the action does no longer generate options files for PackSquash, the inputs
  that changed the contents of such file were removed: `allow_optifine_mod`,
  `zip_spec_conformance_level`, etc.
- Dropped support for previous major releases from the security policy to allow
  us to focus our development efforts better. If you have a good reason for not
  being able to upgrade to the latest major release, please let us know about
  your case so we can consider providing an upgrade path for you.

[Unreleased]:
    https://github.com/ComunidadAylas/PackSquash-action/compare/v4.0.3...HEAD
[4.0.3]:
    https://github.com/ComunidadAylas/PackSquash-action/compare/v4.0.2...v4.0.3
[4.0.2]:
    https://github.com/ComunidadAylas/PackSquash-action/compare/v4.0.1...v4.0.2
[4.0.1]:
    https://github.com/ComunidadAylas/PackSquash-action/compare/v4.0.0...v4.0.1
[4.0.0]:
    https://github.com/ComunidadAylas/PackSquash-action/compare/v3.0.2...v4.0.0
